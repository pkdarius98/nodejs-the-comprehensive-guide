<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
                    
        <head><meta content="application/xhtml+xml; charset=utf-8" http-equiv="Content-Type"/>
            <meta content="application/xhtml+xml; charset=utf-8" name="content-type"/>
            <meta content="Node on the Command Line" name="title"/>
            <meta content="Sebastian Springer" name="author"/>
            <meta content="Rheinwerk Publishing" name="publisher"/>
            <meta content="© 2022 by Rheinwerk Publishing Inc., Boston (MA)" name="copyright"/>
            <meta content="Node.js - The Comprehensive Guide - Node on the Command Line" name="description"/>
            <meta content="en" name="language"/>
            <title>Node on the Command Line</title>
            <link href="common/main.css" rel="stylesheet" type="text/css"/>
<meta content="urn:uuid:e0000000-0000-0000-0000-000029756394" name="Adept.expected.resource"/>
        </head>
    


                    <body class="office_us type_kapitel">
                        <div id="main"><h1 class="t1" id="h15">15    <a id="p453"/>Node on the Command Line</h1><p class="introductorynote indent_chapter_double">You cannot teach a man anything; you can only help him find it within himself.<br/>—Galileo Galilei</p><p class="standard">In<a class="indexanchor" id="i15_00"/> addition to typical web applications, Node.js can also be used to implement powerful command-line tools<a class="indexanchor" id="i15_01"/>. This is possible because, with Node.js, you have an interface to your operating system that allows you to access not only the file system but also almost all aspects of your system. Another advantage of Node.js on the command line is that you can’t tell whether an application implemented in Node.js is based on JavaScript. As you run your tool directly on the command line, there is no direct indication that Node.js is involved. The distribution of such tools is also quite simple thanks to Node Package Manager (npm)<a class="indexanchor" id="i15_02"/>. For open-source<a class="indexanchor" id="i15_03"/> projects, you can use the infrastructure of the npm registry directly. You can distribute internal projects as files via npm or create a local repository<a class="indexanchor" id="i15_04"/>. <span class="crossreference "><a href="25_001.html#h25">Chapter 25</a></span> describes how this works in detail.</p><p class="standard">The areas of use for command-line tools in Node.js are also very diverse. Starting from small utilities<a class="indexanchor" id="i15_05"/> that support you in your daily development work up to large-scale applications, everything is possible. Most of the time, however, the commands are used in web development<a class="indexanchor" id="i15_06"/> because JavaScript is one of the most commonly used languages in that area, and the relevant interfaces are already available. Thus, applications for handling CSS, HTML, and JavaScript are provided. Testing and analysis tools<a class="indexanchor" id="i15_07"/> are also often written in Node.js. Another big area where Node.js is used is in the build process of web applications, where the goal is to prepare the source code so that it can be distributed to a server system and deployed.</p>
        <h2 class="t2" id="h15.1">15.1    Basic Principles</h2>
        <p class="standard">Before you start writing a command-line tool with Node.js, you need to know some basic principles about commands and how to use them. All commonly used operating systems have a command line where you can execute commands. This is true for macOS and Linux as well as for Windows. In <span class="crossreference "><a href="15_001.html#l15.1">Listing 15.1</a></span>, you can see the execution of a typical shell command<a class="indexanchor" id="i15_08"/> in a Unix environment.</p>
        <div class="listing " id="l15.1"><pre><span class="bold"><samp class="listingcharacter listingcharacter"><a id="p454"/>$ ls -l /usr/local/lib/node_modules/</samp></span><br/>total 0<br/>drwxrwxr-x  23 root    wheel     782 Dec 16 19:42 npm<br/>drwxr-xr-x   8 nobody  41305271  272 Dec 23 02:01 nvm </pre></div>
        <p class="caption "><b>Listing 15.1</b>    
            Command-Line Command on a Unix Shell</p>
        <p class="standard">A typical feature of a command-line tool is that it’s called directly with no interpreter<a class="indexanchor" id="i15_09"/> or server process required. Normally, you can also omit the file extension of the command. In addition, most commands are located in the system’s search path<a class="indexanchor" id="i15_10"/>, so they can be executed without an explicit path name. Only in the rarest cases is a command used on its own because you usually specify additional options<a class="indexanchor" id="i15_11"/> and arguments<a class="indexanchor" id="i15_12"/> to affect the execution. In the example in <span class="crossreference "><a href="15_001.html#l15.1">Listing 15.1</a></span>, the <samp class="listingcharacter listingcharacter">ls</samp> command is used to create a listing of files in a directory. The <samp class="listingcharacter listingcharacter">-l</samp> option provides a more verbose output, and the <samp class="listingcharacter listingcharacter">/usr/local/lib/node_modules</samp> argument determines which directory you’re interested in. This structure isn’t arbitrary, but follows a convention that you should follow when creating a command-line tool with Node.js.</p>
        
            <h3 class="t3" id="h15.1.1">15.1.1    Structure<a class="indexanchor" id="i15_13"/></h3>
            <p class="standard">Node.js gives you a lot of leeway when building a command-line application. Although this is a great advantage for you because you’re hardly restricted, it quickly turns into a disadvantage for the users of your application if every command on the command line has to be used differently. For this reason, you should make sure your commands always have the following structure: <samp class="listingcharacter listingcharacter">&lt;command&gt; &lt;options&gt; &lt;arguments&gt;</samp>. The individual components of a command line are as follows:</p>
            <ul>
                <li>
                    <p class="standard first-item last-item"><span class="bold">Command</span><a class="indexanchor" id="i15_14"/><br/>The command designates the executable file of the tool. Normally, you can omit file name extensions<a class="indexanchor" id="i15_15"/><a class="indexanchor" id="i15_16"/> such as <span class="italic">.exe</span> or <span class="italic">.bat</span>. If you haven’t placed the file within the search path<a class="indexanchor" id="i15_17"/> of your system, you must prefix the command with the absolute or relative path to the file. So, for frequently used commands, it’s recommended to expand the system search path and copy the tool executable to a location that is included in the search path, or at least create a shortcut to it.</p>
                </li>
                <li>
                    <p class="standard first-item last-item"><span class="bold">Options</span><a class="indexanchor" id="i15_18"/><br/>The options of a command affect its behavior<a class="indexanchor" id="i15_19"/>. This means you can use options to control what exactly your application should do. You’ve already seen a corresponding example in <span class="crossreference "><a href="15_001.html#l15.1">Listing 15.1</a></span> where the <samp class="listingcharacter listingcharacter">-l</samp> option made sure that more details were displayed. With regard to options, there is a convention that most applications follow. If you prefix an option only with <samp class="listingcharacter listingcharacter">–</samp>, the option should consist of only one letter. If the option requires a value, it’s separated from the option by a space. Several options<a class="indexanchor" id="i15_20"/> in the short notation can be combined. Thus, an <samp class="listingcharacter listingcharacter">ls -l -a</samp> becomes an <samp class="listingcharacter listingcharacter">ls -la</samp>. In the more verbose notation<a class="indexanchor" id="i15_21"/> for options, you must use two <samp class="listingcharacter listingcharacter">-</samp> as prefix. The name of the option <a id="p455"/>in this case consists of a word, and the value is separated from the option by <samp class="listingcharacter listingcharacter">=</samp>. In this context, it isn’t possible to group several options together as in the shorthand notation. An example of this notation is <samp class="listingcharacter listingcharacter">grep --recursive --max-count=3 "node.js" *</samp>.</p>
                </li>
                <li>
                    <p class="standard first-item last-item"><span class="bold">Arguments</span><a class="indexanchor" id="i15_22"/><br/>Arguments enable you to pass information<a class="indexanchor" id="i15_23"/> to the command. For the directory listing in <span class="crossreference "><a href="15_001.html#l15.1">Listing 15.1</a></span>, the argument consists of the name of the directory to be displayed. For example, the <samp class="listingcharacter listingcharacter">grep</samp> command accepts two arguments. If you run <samp class="listingcharacter listingcharacter">grep --recursive "node.js" *</samp>, the first argument is the character string <samp class="listingcharacter listingcharacter">node.js</samp> to search for, while <samp class="listingcharacter listingcharacter">*</samp> is a wildcard for all files and directories in the current directory.</p>
                </li>
            </ul>
            <p class="standard">As is so often the case in Node.js, you should be careful with the flexibility the platform gives you. For example, you can read the entire command line and determine the format of options and arguments yourself. This allows you to use a <samp class="listingcharacter listingcharacter">%</samp> rather than a <samp class="listingcharacter listingcharacter">–</samp> to indicate options. However, you’d better stick to the convention described earlier and thus allow the users of your application to use it as they are used to. By default, almost all commands support options such as <samp class="listingcharacter listingcharacter">-h</samp> or <samp class="listingcharacter listingcharacter">--help</samp> for a short help, so you can get a quick start with the features of the application.</p>
        
        
            <h3 class="t3" id="h15.1.2">15.1.2    Executability<a class="indexanchor" id="i15_24"/></h3>
            <p class="standard">To run a command on your system, you must meet some requirements<a class="indexanchor" id="i15_25"/>. During the course of this chapter, you’ll learn how to design your application. There are additionally some conditions that have to be fulfilled on the operating system side.</p>
            <p class="standard">As mentioned earlier, the executable file of your application must be findable. If you install the application globally via the npm, you must make sure that the file is located in a directory that is in the search path of your system. If you want to install your application without the npm, you have to adjust your search path manually. On a Windows system, you can do this by extending the <samp class="listingcharacter listingcharacter">PATH</samp> variable<a class="indexanchor" id="i15_26"/> in the system settings. You proceed in a similar way on a Unix-based system. Again, the environment variable is called <samp class="listingcharacter listingcharacter">PATH</samp> and contains a list of directories separated by colons.</p>
            <p class="standard">Especially on Unix systems, you must set special permissions<a class="indexanchor" id="i15_27"/> for an application to run on the command line. The Unix permission system provides for three types of permissions: read, write, and execute. You can set them for the owner of the file, the assigned group, and all other users of the system. For you to run the application, the executing user must have at least read and execute permissions<a class="indexanchor" id="i15_28"/> on the file. If that isn’t the case, you’ll receive an error message informing you of the missing authorization. You can set the permission on the command line using the <samp class="listingcharacter listingcharacter">chmod +rx index.js</samp> command. This assumes that the starting point of your application is in the file named <span class="italic">index.js</span>. The <samp class="listingcharacter listingcharacter">chmod</samp><a class="indexanchor" id="i15_29"/> command in this case ensures that any user on the system can both read and execute the file. With this prior knowledge, you can now move on to creating your command-line application.</p>
        
    </div><p class="signatur"/>
                    </body>
                </html>