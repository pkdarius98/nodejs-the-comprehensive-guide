<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
                    
        <head><meta content="application/xhtml+xml; charset=utf-8" http-equiv="Content-Type"/>
            <meta content="application/xhtml+xml; charset=utf-8" name="content-type"/>
            <meta content="Package Manager" name="title"/>
            <meta content="Sebastian Springer" name="author"/>
            <meta content="Rheinwerk Publishing" name="publisher"/>
            <meta content="© 2022 by Rheinwerk Publishing Inc., Boston (MA)" name="copyright"/>
            <meta content="Node.js - The Comprehensive Guide - Package Manager" name="description"/>
            <meta content="en" name="language"/>
            <title>Package Manager</title>
            <link href="common/main.css" rel="stylesheet" type="text/css"/>
<meta content="urn:uuid:e0000000-0000-0000-0000-000029756394" name="Adept.expected.resource"/>
        </head>
    


                    <body class="office_us type_kapitel">
                        <div id="main">
        <h2 class="t2" id="h21.3">21.3    Tools for Node Package Manager<a class="indexanchor" id="i21_89"/></h2>
        <p class="standard">The npm is used for installing and managing packages and their dependencies. This usage gives rise to a whole range of other problems that aren’t the focus of the package manager. The following sections will introduce you to two of these problems and show you how to solve them with the help of simple tools.</p>
        
            <h3 class="t3" id="h21.3.1">21.3.1    Node License Finder<a class="indexanchor" id="i21_90"/></h3>
            <p class="standard">If you create applications for larger companies, then sooner or later, you’ll come across the various software licensing models. A fairly common problem in this context is the listing of licenses in use. The difficulty is that for such a list, you usually need to list not only the actually used software but also the licenses of the plug-ins and modules in use, that is, also the licenses of the individual npm packages being used. In the case of larger applications, their number quickly reaches the three-digit range. This makes retrieving the license information a bigger task.</p>
            <p class="standard"><a id="p635"/>One solution to this is provided by the <samp class="listingcharacter listingcharacter">nlf</samp> package<a class="indexanchor" id="i21_91"/>, that is, the Node License Finder. This command-line tool scans the installed dependencies and displays the respective license. The starting point of the search is the <span class="italic">package.json</span> file of the project, which must be present so that <samp class="listingcharacter listingcharacter">nlf</samp> can be used at all. As sources for license information, the <samp class="listingcharacter listingcharacter">nlf</samp> uses the <span class="italic">package.json</span> file, the <span class="italic">license</span> file, and the <span class="italic">readme.md</span> file of the respective package. The installation is done via the <samp class="listingcharacter listingcharacter">npm install -g nlf</samp> command. <span class="crossreference "><a href="21_003.html#l21.25">Listing 21.25</a></span> shows how you can use <samp class="listingcharacter listingcharacter">nlf</samp>.</p>
            <div class="listing " id="l21.25"><pre>$ <span class="bold"><samp class="listingcharacter listingcharacter">nlf</samp></span><br/>accepts@1.3.7 [license(s): MIT]<br/>├── package.json:  MIT<br/>└── license files: MIT<br/><br/>array-flatten@1.1.1 [license(s): MIT]<br/>├── package.json:  MIT<br/>├── license files: MIT<br/>└── readme files: MIT </pre></div>
            <p class="caption "><b>Listing 21.25</b>    
            Abbreviated Output of “nlf” for an Express Application</p>
            <p class="standard">You can use the <samp class="listingcharacter listingcharacter">-r</samp> command-line option to control the depth at which to search. The <samp class="listingcharacter listingcharacter">-d</samp> option specifies that the search shouldn’t include the <samp class="listingcharacter listingcharacter">devDependencies</samp>. With <samp class="listingcharacter listingcharacter">-s</samp> you can manipulate the form of the summary at the end of the output. The available formats are <samp class="listingcharacter listingcharacter">off</samp> (turns off the summary), <samp class="listingcharacter listingcharacter">simple</samp> (default), and <samp class="listingcharacter listingcharacter">detail</samp> (licenses and the packages you use are displayed in a tree). Finally, the <samp class="listingcharacter listingcharacter">-c</samp> option ensures that the output is in comma-separated values (CSV) format.</p>
        
        
            <h3 class="t3" id="h21.3.2">21.3.2    Verdaccio<a class="indexanchor" id="i21_92"/></h3>
            <p class="standard">The npm repository is a reliable and very accessible source for packages. Nevertheless, there are environments that either can’t reach the repository or require a very high degree of availability. To solve this problem, you can host the repository yourself. In general, you can re-create the npm repository infrastructure yourself, but this requires a relatively high amount of effort. A much easier way is to use tools such as Verdaccio. It’s also possible to set up your own local npm repository with Nexus.</p>
            <p class="standard">This section describes how you can build your own repository using Verdaccio. The tool is installed via npm. Because it’s a command-line tool, you need to install Verdaccio globally. After the installation via the <samp class="listingcharacter listingcharacter">npm install -g verdaccio</samp> command, the tool is available for use.</p>
            <p class="standard">You can then use the <samp class="listingcharacter listingcharacter">verdaccio</samp> command to start the service, which will be bound to the local network interface and port <samp class="listingcharacter listingcharacter">4873</samp>. After that, you just need to configure your npm to use Verdaccio as registry. You can do this via the <samp class="listingcharacter listingcharacter">npm set registry http://localhost:4873</samp> command.</p>
            <p class="standard"><a id="p636"/>Verdaccio then assumes the role of a proxy<a class="indexanchor" id="i21_93"/>. The service receives all requests and tries to answer them. If it doesn’t have sources for a package, it downloads them from the npm repository and stores them locally.</p>
            <p class="standard">Another feature of Verdaccio is that it enables you to publish packages to your local instance and then consume them exclusively. You just need to create a user via <samp class="listingcharacter listingcharacter">npm adduser --registry http://localhost:4873/</samp>. Due to the reconfiguration of npm, your packages arrive directly in Verdaccio.</p>
        
        
            <h3 class="t3" id="h21.3.3">21.3.3    npm-check-updates<a class="indexanchor" id="i21_94"/></h3>
            <p class="standard">The <samp class="listingcharacter listingcharacter">npm-check-updates</samp> package, <samp class="listingcharacter listingcharacter">ncu</samp><a class="indexanchor" id="i21_95"/> for short, provides a functionality similar to <samp class="listingcharacter listingcharacter">npm update</samp>, but you can make updates with this tool even if the policies in the <span class="italic">package.json</span> file don’t allow that. The tool is installed via the <samp class="listingcharacter listingcharacter">npm install -g npm-check-updates</samp> command. For example, if you have version 3 of Express installed in your application, you’ll receive an output like the one shown in <span class="crossreference "><a href="21_003.html#l21.26">Listing 21.26</a></span> when you run the <samp class="listingcharacter listingcharacter">ncu</samp> command.</p>
            <div class="listing " id="l21.26"><pre>$ <span class="bold"><samp class="listingcharacter listingcharacter">ncu</samp></span><br/>Checking /srv/node/package.json<br/><br/>[====================] 1/1 100%<br/><br/> express  ^3.21.2  →  ^4.17.1 <br/><br/>Run ncu -u to upgrade package.json </pre></div>
            <p class="caption "><b>Listing 21.26</b>    
            Running “ncu”</p>
            <p class="standard">Running the <samp class="listingcharacter listingcharacter">ncu</samp> command doesn’t yet change anything in your application—not until you specify the <samp class="listingcharacter listingcharacter">-u</samp> option will the <span class="italic">package.json</span> file of your application be rewritten, as you can see in <span class="crossreference "><a href="21_003.html#l21.27">Listing 21.27</a></span>.</p>
            <div class="listing " id="l21.27"><pre>$ <span class="bold"><samp class="listingcharacter listingcharacter">ncu -u</samp></span><br/>Upgrading /srv/node/package.json<br/>[====================] 1/1 100%<br/><br/> express  ^3.21.2  →  ^4.17.1 <br/><br/>Run npm install to install new versions. </pre></div>
            <p class="caption "><b>Listing 21.27</b>    
            Update via “ncu”</p>
            <p class="standard">However, this process doesn’t yet install the packages. To do this, you must first run the <samp class="listingcharacter listingcharacter">npm install</samp> command. Updating via <samp class="listingcharacter listingcharacter">ncu</samp> takes effect only if the available version of the package contradicts the current policy in <span class="italic">package.json</span>.</p>
        
        
            <h3 class="t3" id="h21.3.4">21.3.4    <a id="p637"/>npx<a class="indexanchor" id="i21_96"/></h3>
            <p class="standard">Since version 5.2, npm delivers not only the <samp class="listingcharacter listingcharacter">npm</samp> but also the <samp class="listingcharacter listingcharacter">npx</samp> command. <samp class="listingcharacter listingcharacter">npx</samp> is a package runner, which means that this tool provides you with a convenient interface for running command-line programs<a class="indexanchor" id="i21_97"/> such as <samp class="listingcharacter listingcharacter">nodemon</samp>. If you have <samp class="listingcharacter listingcharacter">nodemon</samp> installed locally in your application as <samp class="listingcharacter listingcharacter">devDependency</samp>, you must either create an npm script or run the tool via the relative path, that is, <samp class="listingcharacter listingcharacter">./node_modules/.bin/nodemon</samp>, to have your application launch automatically when you make changes to the source code. <samp class="listingcharacter listingcharacter">npx</samp> solves this problem for you by finding locally installed command-line tools and running them for you. This allows you to run <samp class="listingcharacter listingcharacter">nodemon</samp> via the <samp class="listingcharacter listingcharacter">npx nodemon index.js</samp> command, and you don’t need to install <samp class="listingcharacter listingcharacter">nodemon</samp> globally for this.</p>
            <p class="standard">Another interesting feature of <samp class="listingcharacter listingcharacter">npx</samp> is that you don’t need to install the package you want to run up front. There are numerous tools you only need when initializing your application. An example from frontend development is the <samp class="listingcharacter listingcharacter">create-react-app</samp> package, which can be used to initialize a React app. The <samp class="listingcharacter listingcharacter">npx create-react-app my-app</samp> command causes <samp class="listingcharacter listingcharacter">npx</samp> to temporarily download the package and run it. Subsequently, the sources of the package are discarded.</p>
        
    </div><p class="signatur"/>
                    </body>
                </html>