<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
                    
        <head><meta content="application/xhtml+xml; charset=utf-8" http-equiv="Content-Type"/>
            <meta content="application/xhtml+xml; charset=utf-8" name="content-type"/>
            <meta content="Streams" name="title"/>
            <meta content="Sebastian Springer" name="author"/>
            <meta content="Rheinwerk Publishing" name="publisher"/>
            <meta content="© 2022 by Rheinwerk Publishing Inc., Boston (MA)" name="copyright"/>
            <meta content="Node.js - The Comprehensive Guide - Streams" name="description"/>
            <meta content="en" name="language"/>
            <title>Streams</title>
            <link href="common/main.css" rel="stylesheet" type="text/css"/>
<meta content="urn:uuid:e0000000-0000-0000-0000-000029756394" name="Adept.expected.resource"/>
        </head>
    


                    <body class="office_us type_kapitel">
                        <div id="main">
        <h2 class="t2" id="h18.6">18.6    Gulp<a class="indexanchor" id="i18_83"/></h2>
        <p class="standard">Gulp is a build system for JavaScript. With this application, you can automate routine development tasks. Gulp is written entirely in JavaScript and is based on Node.js. For the individual tasks, there are various plug-ins<a class="indexanchor" id="i18_84"/> you can load and use. Typical tasks you do with gulp involve reviewing your source code, running tests, or minifying your source code.</p>
        <p class="standard">The big difference to other build<a class="indexanchor" id="i18_85"/> systems such as Grunt<a class="indexanchor" id="i18_86"/> is that gulp is based on streams and views all operations as data streams. This change in approach means that you use gulp to program your build process, whereas Grunt expects you to use configuration objects.</p>
        
            <h3 class="t3" id="h18.6.1">18.6.1    Installation<a class="indexanchor" id="i18_87"/></h3>
            <p class="standard">To be able to use gulp, you must first install it. The installation process consists of several stages. In the first step, you install gulp globally via the <samp class="listingcharacter listingcharacter">npm install -g gulp-cli</samp> command. This allows you to access the <samp class="listingcharacter listingcharacter">gulp</samp> command line command from anywhere on your system. Once you run the <samp class="listingcharacter listingcharacter">gulp</samp> command on the command line after this first step, you’ll receive an error message telling you that no local version of gulp could be found. In the second step, you complete the setup process with the local installation of gulp using the <samp class="listingcharacter listingcharacter">npm install -save-dev gulp</samp> command. gulp is usually installed as <samp class="listingcharacter listingcharacter">devDependency</samp> because it’s only used during development. </p>
            <p class="standard">After installing the components, the next thing you need to do is create the configuration for your build process. The naming convention states that the file should be named <span class="italic">gulpfile.js</span><a class="indexanchor" id="i18_88"/>. This file contains JavaScript source code, which follows the conventions of gulp and implements the individual tasks of the build process. Within the configuration file, you can access all features of Node.js, including the module system and additionally installed npm packages.</p>
        
        
            <h3 class="t3" id="h18.6.2">18.6.2    <a id="p571"/>Example of a Build Process<a class="indexanchor" id="i18_89"/> with Gulp</h3>
            <p class="standard"><span class="crossreference "><a href="18_006.html#l18.22">Listing 18.22</a></span> contains an example of a <span class="italic">gulpfile.js</span> file. For the example to work, you need to install a few more plug-ins first. In addition to the local installation, the following NPM packages<a class="indexanchor" id="i18_90"/> are also required: <samp class="listingcharacter listingcharacter">gulp-babel</samp>, <samp class="listingcharacter listingcharacter">gulp-concat</samp>, <samp class="listingcharacter listingcharacter">gulp-uglify</samp>, and <samp class="listingcharacter listingcharacter">gulp-rename</samp>. As the name of the packages suggests, these are components for your build process. They’re only needed for development purposes and therefore should be installed as <samp class="listingcharacter listingcharacter">devDependency</samp> with the <samp class="listingcharacter listingcharacter">--save-dev</samp> option.</p>
            <p class="standard">Once you have set the stage, you can move on to creating the <span class="italic">gulpfile.js</span> file as shown in <span class="crossreference "><a href="18_006.html#l18.22">Listing 18.22</a></span>.</p>
            <div class="listing " id="l18.22"><pre><span class="rot">import</span><span class="schwarz"> gulp </span><span class="rot">from</span><span class="schwarz"> </span><span class="hellblau">'gulp'</span><span class="schwarz">;</span><span class="schwarz"><br/></span><span class="rot">import</span><span class="schwarz"> babel </span><span class="rot">from</span><span class="schwarz"> </span><span class="hellblau">'gulp-babel'</span><span class="schwarz">;</span><span class="schwarz"><br/></span><span class="rot">import</span><span class="schwarz"> concat </span><span class="rot">from</span><span class="schwarz"> </span><span class="hellblau">'gulp-concat'</span><span class="schwarz">;</span><span class="schwarz"><br/></span><span class="rot">import</span><span class="schwarz"> uglify </span><span class="rot">from</span><span class="schwarz"> </span><span class="hellblau">'gulp-uglify'</span><span class="schwarz">;</span><span class="schwarz"><br/></span><span class="rot">import</span><span class="schwarz"> rename </span><span class="rot">from</span><span class="schwarz"> </span><span class="hellblau">'gulp-rename'</span><span class="schwarz">;</span><span class="schwarz"><br/></span> <br/><span class="rot">export</span><span class="schwarz"> </span><span class="rot">default</span><span class="schwarz"> </span><span class="schwarz">()</span><span class="schwarz"> </span><span class="dunkelblau">=&gt;</span><span class="schwarz"><br/></span>  gulp<br/>    <span class="schwarz">.src(</span><span class="hellblau">'js/*.js'</span><span class="schwarz">)</span><span class="schwarz"><br/></span>    <span class="schwarz">.pipe(concat(</span><span class="hellblau">'all.js'</span><span class="schwarz">))</span><span class="schwarz"><br/></span>    <span class="schwarz">.pipe(</span><span class="schwarz">gulp</span><span class="schwarz">.dest(</span><span class="hellblau">'dist'</span><span class="schwarz">))</span><span class="schwarz"><br/></span>    <span class="schwarz">.pipe(babel())</span><span class="schwarz"><br/></span>    <span class="schwarz">.pipe(rename(</span><span class="hellblau">'all.min.js'</span><span class="schwarz">))</span><span class="schwarz"><br/></span>    <span class="schwarz">.pipe(uglify())</span><span class="schwarz"><br/></span>    <span class="schwarz">.pipe(</span><span class="schwarz">gulp</span><span class="schwarz">.dest(</span><span class="hellblau">'dist'</span><span class="schwarz">));</span><span class="schwarz"> </span></pre></div>
            <p class="caption "><b>Listing 18.22</b>    
            Sample gulpfile.js File</p>
            <p class="standard">The gulp configuration<a class="indexanchor" id="i18_91"/> consists of a regular Node.js application. At the start of the file, you include the required modules and configure the build steps within a simple arrow function. <samp class="listingcharacter listingcharacter">export default</samp> makes sure you can execute the task directly via the <samp class="listingcharacter listingcharacter">gulp</samp> command without any additional parameters. The concatenation of the individual tasks is done in the form of a data stream, as you know it from the Node.js streams. The data source, that is, the readable stream, is created by <samp class="listingcharacter listingcharacter">gulp.src</samp>. Here, you specify which files you want to transform. These files are combined into one file by the <samp class="listingcharacter listingcharacter">concat</samp> step and written to the <span class="italic">all.js</span> file. This file is converted with the Babel transpiler<a class="indexanchor" id="i18_92"/>, renamed to <span class="italic">all.min.js</span>, and minified via UglifyJS<a class="indexanchor" id="i18_93"/>. The final result gets written to the <span class="italic">dist</span> directory. As usual with streams, you can exchange or omit the intermediate steps as you like.</p>
            <p class="standard">For gulp, there is a plug-in available for almost every possible task, which you can install and include in a similar way to the ones shown in the example. Recently, however, download numbers for legacy JavaScript build systems such as Grunt and gulp have stagnated. They are replaced by modern bundlers such as webpack, which are also <a id="p572"/>based on Node.js. Nevertheless, gulp is a viable example of how you can use streams for your purposes in practice.</p>
        
    </div><p class="signatur"/>
                    </body>
                </html>