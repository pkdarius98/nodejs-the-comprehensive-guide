<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
                    
        <head><meta content="application/xhtml+xml; charset=utf-8" http-equiv="Content-Type"/>
            <meta content="application/xhtml+xml; charset=utf-8" name="content-type"/>
            <meta content="Node on the Command Line" name="title"/>
            <meta content="Sebastian Springer" name="author"/>
            <meta content="Rheinwerk Publishing" name="publisher"/>
            <meta content="© 2022 by Rheinwerk Publishing Inc., Boston (MA)" name="copyright"/>
            <meta content="Node.js - The Comprehensive Guide - Node on the Command Line" name="description"/>
            <meta content="en" name="language"/>
            <title>Node on the Command Line</title>
            <link href="common/main.css" rel="stylesheet" type="text/css"/>
<meta content="urn:uuid:e0000000-0000-0000-0000-000029756394" name="Adept.expected.resource"/>
        </head>
    


                    <body class="office_us type_kapitel">
                        <div id="main">
        <h2 class="t2" id="h15.4">15.4    Tools<a class="indexanchor" id="i15_76"/></h2>
        <p class="standard">Node.js has also established itself as a valuable tool on the command line. For this reason, you’ll find ready-made solutions for numerous problems in the area of command-line applications, which you can install as packages in your application. In the following sections, you’ll be introduced to three of these tools—Commander, chalk, and node-emoji—and integrate them into your Math Trainer.</p>
        
            <h3 class="t3" id="h15.4.1">15.4.1    Commander<a class="indexanchor" id="i15_77"/></h3>
            <p class="standard">As you’ve seen in the previous section, searching the command line for specific options involves a certain amount of work<a class="indexanchor" id="i15_78"/>. The situation gets even more inconvenient at this <a id="p470"/>point if you also want to provide the shorthand notation<a class="indexanchor" id="i15_79"/> of options instead of what we’ve done so far in the example. In this case, you normally don’t use equal signs as separators between the option and the value, so you also have to adjust the routine here. For parsing the command line, you can include Commander in your application. You can install the package via the <samp class="listingcharacter listingcharacter">npm install commander</samp> command. Because you’ve already swapped out the parsing of the command line to a separate file in the previous step, the adjustments for integrating Commander are limited to the <span class="italic">lib/getOptions.js</span> file. The updated version of this file is shown in <span class="crossreference "><a href="15_004.html#l15.20">Listing 15.20</a></span>.</p>
            <div class="listing " id="l15.20"><pre><span class="rot">import</span><span class="schwarz"> program </span><span class="rot">from</span><span class="schwarz"> </span><span class="hellblau">'commander'</span><span class="schwarz">;</span><span class="schwarz"><br/></span> <br/><span class="rot">export</span><span class="schwarz"> </span><span class="rot">default</span><span class="schwarz"> </span><span class="schwarz">(</span><span class="schwarz">levelDefault </span><span class="dunkelblau">=</span><span class="schwarz"> </span><span class="schwarz">2,</span><span class="schwarz"> amountDefault </span><span class="dunkelblau">=</span><span class="schwarz"> </span><span class="schwarz">4)</span><span class="schwarz"> </span><span class="dunkelblau">=&gt;</span><span class="schwarz"> </span><span class="schwarz">{</span><span class="schwarz"><br/></span>  program<br/>    <span class="schwarz">.version(</span><span class="hellblau">'1.0.0'</span><span class="schwarz">)</span><span class="schwarz"><br/></span>    <span class="schwarz">.option(</span><span class="schwarz"><br/></span>      <span class="hellblau">'-l, --level &lt;n&gt;'</span><span class="schwarz">,</span><span class="schwarz"><br/></span>      <span class="hellblau">'Difficulty level of tasks (1-3)'</span><span class="schwarz">,</span><span class="schwarz"><br/></span>      parseInt<span class="schwarz">,</span><span class="schwarz"><br/></span>      levelDefault<span class="schwarz">,</span><span class="schwarz"><br/></span>    <span class="schwarz">)</span><span class="schwarz"><br/></span>    <span class="schwarz">.option(</span><span class="hellblau">'-a, --amount &lt;n&gt;'</span><span class="schwarz">,</span><span class="schwarz"> </span><span class="hellblau">'Number of tasks'</span><span class="schwarz">,</span><span class="schwarz"> parseInt</span><span class="schwarz">,</span><span class="schwarz"> </span><img alt="inline image" class="inline_image" src="bilder/umbruchpfeil.png"/><br/>      amountDefault<span class="schwarz">)</span><span class="schwarz"> </span><br/>    <span class="schwarz">.parse(</span><span class="schwarz">process</span><span class="schwarz">.</span><span class="schwarz">argv</span><span class="schwarz">);</span><span class="schwarz"><br/></span> <br/>  <span class="rot">const</span><span class="schwarz"> options </span><span class="dunkelblau">=</span><span class="schwarz"> program</span><span class="schwarz">.opts();</span><span class="schwarz"><br/></span> <br/>  <span class="rot">return</span><span class="schwarz"> </span><span class="schwarz">{</span><span class="schwarz"><br/></span>    level<span class="schwarz">:</span><span class="schwarz"> options</span><span class="schwarz">.</span><span class="schwarz">level</span><span class="schwarz">,</span><span class="schwarz"><br/></span>    amount<span class="schwarz">:</span><span class="schwarz"> options</span><span class="schwarz">.</span><span class="schwarz">amount</span><span class="schwarz">,</span><span class="schwarz"><br/></span>  <span class="schwarz">};</span><span class="schwarz"><br/></span><span class="schwarz">};</span><span class="schwarz"> </span></pre></div>
            <p class="caption "><b>Listing 15.20</b>    
            Integrating Commander (lib/getOptions.js)</p>
            <p class="standard">Due to the customization in <span class="crossreference "><a href="15_004.html#l15.20">Listing 15.20</a></span>, the source code of your application has become simpler, and you also gained additional features. Thus, by default, Commander supports the <samp class="listingcharacter listingcharacter">-V</samp> and <samp class="listingcharacter listingcharacter">--version</samp> options to display the version<a class="indexanchor" id="i15_80"/> of the application. In addition, when the application is invoked with the <samp class="listingcharacter listingcharacter">-h</samp> or <samp class="listingcharacter listingcharacter">--help</samp> option, a help block<a class="indexanchor" id="i15_81"/> describing how to use the command is displayed.</p>
            <p class="standard">After these changes, you no longer support only the long version of the options, but also a shortened version. If you call your application with the <samp class="listingcharacter listingcharacter">-h</samp> option, you’ll see an output like the one shown in <span class="crossreference "><a href="15_004.html#l15.21">Listing 15.21</a></span>.</p>
            <div class="listing " id="l15.21"><pre><span class="bold"><samp class="listingcharacter listingcharacter"><a id="p471"/>$ math-trainer -h<br/></samp></span><br/>  Usage: math-trainer [options]<br/><br/>  Options:<br/><br/>    -V, --version     output the version number<br/>    -l, --level &lt;n&gt;   difficulty level of tasks (1-3) (default: 2)<br/>    -a, --amount &lt;n&gt;  number of tasks (default: 4)<br/>    -h, --help        output usage information </pre></div>
            <p class="caption "><b>Listing 15.21</b>    
            Display of the Math Trainer Help</p>
            <p class="standard">Using the <samp class="listingcharacter listingcharacter">option</samp> method of the Commander package, you can define the individual options<a class="indexanchor" id="i15_82"/> of your application. As the first argument, the method expects the name of the option. Here you can specify both the short and the long variant. If a value is to be passed to the application via the option, you can specify it afterwards. You have two different options for specifying the value: If you put the value in angle brackets, as in this example, it’s a mandatory value<a class="indexanchor" id="i15_83"/>. If you want to define an optional option, you can use square brackets here. The second parameter of the <samp class="listingcharacter listingcharacter">options</samp> method represents the description of the option. This is displayed in the help menu. As a third argument, you can pass a function to manipulate the value. For the Math Trainer application, use the <samp class="listingcharacter listingcharacter">parseInt</samp> function to convert the passed value into a number. The last parameter allows you to pass a default value for the option. Commander then automatically inserts the string <samp class="listingcharacter listingcharacter">default: &lt;value&gt;</samp> into the option description.</p>
            <p class="standard">For Commander to work, you must use the <samp class="listingcharacter listingcharacter">parse</samp> method to specify which data structure to evaluate. In most cases, this will be the <samp class="listingcharacter listingcharacter">process.argv</samp> array, but here you have the option to specify any array that follows the rules of <samp class="listingcharacter listingcharacter">process.argv</samp>.</p>
            <p class="standard">All methods of the Commander object return the object itself, so that a fluent interface<a class="indexanchor" id="i15_84"/> notation becomes possible, and you can directly concatenate the method calls.</p>
            <p class="standard">You can obtain the values that were passed when the application was called by using the <samp class="listingcharacter listingcharacter">opts</samp> method. This method returns an object containing the individual options and their associated values as key-value pairs.</p>
            <p class="standard">The Commander project site can be found at <span class="url"><a href="https://github.com/tj/commander.js">https://github.com/tj/commander.js</a></span>. A lightweight alternative to Commander.js is available in the form of <samp class="listingcharacter listingcharacter">minimist</samp><a class="indexanchor" id="i15_85"/>. This module deals only with the correct parsing of command-line options. This project can be found at <span class="url"><a href="https://github.com/substack/minimist">https://github.com/substack/minimist</a></span>.</p>
        
        
            <h3 class="t3" id="h15.4.2">15.4.2    Chalk<a class="indexanchor" id="i15_86"/></h3>
            <p class="standard">A feature that is often underestimated is the formatting of the command line. It allows you to highlight important terms and thus guide the user on the command line. You <a id="p472"/>can apply colors and other formatting<a class="indexanchor" id="i15_87"/> using control characters directly in <samp class="listingcharacter listingcharacter">console.log</samp>, for example. <span class="crossreference "><a href="15_004.html#l15.22">Listing 15.22</a></span> shows how this works.</p>
            <div class="listing " id="l15.22"><pre><span class="magenta">console</span><span class="schwarz">.log(</span><span class="hellblau">'\u001b[33m yellow'</span><span class="schwarz">);</span><span class="schwarz"><br/></span><span class="magenta">console</span><span class="schwarz">.log(</span><span class="hellblau">'\u001b[31m red'</span><span class="schwarz">);</span><span class="schwarz"><br/></span><span class="magenta">console</span><span class="schwarz">.log(</span><span class="hellblau">'\u001b[34m blue'</span><span class="schwarz">);</span><span class="schwarz"><br/></span><span class="magenta">console</span><span class="schwarz">.log(</span><span class="hellblau">'\u001b[0m'</span><span class="schwarz">);</span><span class="schwarz"> </span></pre></div>
            <p class="caption "><b>Listing 15.22</b>    
            Coloring the Console</p>
            <p class="standard">The output of this example consists of the character strings <samp class="listingcharacter listingcharacter">yellow</samp>, <samp class="listingcharacter listingcharacter">red</samp>, and <samp class="listingcharacter listingcharacter">blue</samp>, each colored correspondingly. The last line resets the color<a class="indexanchor" id="i15_88"/> of the console back to its original state. The string <samp class="listingcharacter listingcharacter">\u001b[4m</samp> allows you to underline the subsequent characters. Other features include italic<a class="indexanchor" id="i15_89"/>, strikethrough<a class="indexanchor" id="i15_90"/>, and bold font<a class="indexanchor" id="i15_91"/>. You can also change the background color of the console. Admittedly, dealing with ANSI control characters<a class="indexanchor" id="i15_92"/> in development isn’t always convenient. Applying styles on the console is such a common problem that a module called <samp class="listingcharacter listingcharacter">chalk</samp> comprehensively solves this problem for you. It can be installed with the npm using the <samp class="listingcharacter listingcharacter">npm install chalk</samp> command. The code you implemented in <span class="crossreference "><a href="15_004.html#l15.22">Listing 15.22</a></span> via control characters can be implemented more elegantly with chalk using meaningful function names. The result shown in <span class="crossreference "><a href="15_004.html#l15.23">Listing 15.23</a></span> is the same as the one from the previous example.</p>
            <div class="listing " id="l15.23"><pre><span class="rot">import</span><span class="schwarz"> chalk </span><span class="rot">from</span><span class="schwarz"> </span><span class="hellblau">'chalk'</span><span class="schwarz">;</span><span class="schwarz"><br/></span> <br/><span class="magenta">console</span><span class="schwarz">.log(</span><span class="schwarz">chalk</span><span class="schwarz">.yellow(</span><span class="hellblau">'yellow'</span><span class="schwarz">));</span><span class="schwarz"><br/></span><span class="magenta">console</span><span class="schwarz">.log(</span><span class="schwarz">chalk</span><span class="schwarz">.red(</span><span class="hellblau">'red'</span><span class="schwarz">));</span><span class="schwarz"><br/></span><span class="magenta">console</span><span class="schwarz">.log(</span><span class="schwarz">chalk</span><span class="schwarz">.blue(</span><span class="hellblau">'blue'</span><span class="schwarz">));</span><span class="schwarz"> </span></pre></div>
            <p class="caption "><b>Listing 15.23</b>    
            Using Chalk</p>
            <p class="standard">In your Math Trainer application, chalk enables you to format the output of the result in bold and green for success, and bold and red for failure. For this purpose, you must modify the <span class="italic">lib/index.js</span> file after installing<a class="indexanchor" id="i15_93"/> the package, as shown in <span class="crossreference "><a href="15_004.html#l15.24">Listing 15.24</a></span>.</p>
            <div class="listing " id="l15.24"><pre><span class="rot">import</span><span class="schwarz"> </span><span class="schwarz">{</span><span class="schwarz"> createInterface </span><span class="schwarz">}</span><span class="schwarz"> </span><span class="rot">from</span><span class="schwarz"> </span><span class="hellblau">'readline'</span><span class="schwarz">;</span><span class="schwarz"><br/></span><span class="bold"><span class="schwarz"/><samp class="listingcharacter listingcharacter"><span class="rot">import</span><span class="schwarz"> chalk </span><span class="rot">from</span><span class="schwarz"> </span><span class="hellblau">'chalk'</span><span class="schwarz">;</span></samp></span><br/><span class="rot">import</span><span class="schwarz"> createTask </span><span class="rot">from</span><span class="schwarz"> </span><span class="hellblau">'./task.js'</span><span class="schwarz">;</span><br/><span class="rot">import</span><span class="schwarz"> promisedQuestion </span><span class="rot">from</span><span class="schwarz"> </span><span class="hellblau">'./promisedQuestion.js'</span><span class="schwarz">;</span><br/><span class="rot">import</span><span class="schwarz"> getOptions </span><span class="rot">from</span><span class="schwarz"> </span><span class="hellblau">'./getOptions.js'</span><span class="schwarz">;</span><br/> <br/><span class="rot">const</span><span class="schwarz"> { amount, level } </span><span class="dunkelblau">=</span><span class="schwarz"> getOptions();</span><br/> <br/><span class="rot">const</span><span class="schwarz"> operations </span><span class="dunkelblau">=</span><span class="schwarz"> [</span><span class="hellblau">'+'</span><span class="schwarz">, </span><span class="hellblau">'-'</span><span class="schwarz">, </span><span class="hellblau">'*'</span><span class="schwarz">, </span><span class="hellblau">'/'</span><span class="schwarz">];</span><br/><span class="rot">const</span><span class="schwarz"> tasks </span><span class="dunkelblau">=</span><span class="schwarz"> [];</span><br/> <br/>operations.forEach((operation) <span class="dunkelblau">=&gt;</span><span class="schwarz"> {</span><br/><a id="p473"/>  <span class="rot">for</span><span class="schwarz"> (</span><span class="rot">let</span><span class="schwarz"> i </span><span class="dunkelblau">=</span><span class="schwarz"> 0; i </span><span class="dunkelblau">&lt;</span><span class="schwarz"> amount; i</span><span class="dunkelblau">++</span><span class="schwarz">) {</span><br/>    tasks.push(createTask(operation, level));<br/>  }<br/>});<br/> <br/><span class="rot">const</span><span class="schwarz"> rl </span><span class="dunkelblau">=</span><span class="schwarz"> createInterface({</span><br/>  input: process.stdin,<br/>  output: process.stdout,<br/>});<br/> <br/><span class="rot">async</span><span class="schwarz"> </span><span class="rot">function</span><span class="schwarz"> question(index) {</span><br/>  <span class="rot">const</span><span class="schwarz"> result </span><span class="dunkelblau">=</span><span class="schwarz"> </span><span class="rot">await</span><span class="schwarz"> promisedQuestion(</span><span class="violett">`${tasks[index].task} = `</span><span class="schwarz">, rl);</span><br/>  tasks[index].input <span class="dunkelblau">=</span><span class="schwarz"> parseInt(result);</span><br/>  <span class="rot">if</span><span class="schwarz"> (tasks[index].input </span><span class="dunkelblau">===</span><span class="schwarz"> tasks[index].result) {</span><br/>    <span class="magenta">console</span><span class="schwarz">.log(</span><span class="bold"><samp class="listingcharacter listingcharacter">chalk.bold.green(<span class="hellblau">'Correct!'</span><span class="schwarz">)</span></samp></span>);<br/>  } <span class="rot">else</span><span class="schwarz"> {</span><br/>    <span class="magenta">console</span><span class="schwarz">.log(</span><span class="bold"><samp class="listingcharacter listingcharacter">chalk.bold.red(<span class="hellblau">'Wrong'</span><span class="schwarz">)</span></samp></span>);<br/>  }<br/>  <span class="rot">if</span><span class="schwarz"> (</span><span class="dunkelblau">++</span><span class="schwarz">index </span><span class="dunkelblau">&lt;</span><span class="schwarz"> tasks.length) {</span><br/>    question(index);<br/>  } <span class="rot">else</span><span class="schwarz"> {</span><br/>    rl.close();<br/>  }<br/>}<br/> <br/>question(0); <span class="schwarz"/></pre></div>
            <p class="caption "><b>Listing 15.24</b>    
            Using Chalk in Math Trainer (lib/index.js)</p>
            <p class="standard">As you can see in <span class="crossreference "><a href="15_004.html#l15.24">Listing 15.24</a></span>, it’s possible to apply several styles at the same time by concatenating the statements. Another convenient feature of chalk is that it also takes care of resetting the formatting to the console default style<a class="indexanchor" id="i15_94"/> for you after the passed character string has been formatted.</p>
            <p class="standard">The chalk project can be found on GitHub at <span class="url"><a href="https://github.com/chalk/chalk">https://github.com/chalk/chalk</a></span>.</p>
        
        
            <h3 class="t3" id="h15.4.3">15.4.3    node-emoji<a class="indexanchor" id="i15_95"/></h3>
            <p class="standard">One of the most popular tools that uses emojis for console output is the package manager Yarn<a class="indexanchor" id="i15_96"/>. Like chalk, emojis<a class="indexanchor" id="i15_97"/> can be used to direct the user’s attention to a particular output on the console, to make the console clearer because certain states can be expressed more quickly via an emoji than via text, and, finally, to liven up your application a bit by using the right emojis in the appropriate places. Because JavaScript supports the Unicode character set<a class="indexanchor" id="i15_98"/>, it’s possible to use Unicode emojis directly. An <a id="p474"/>alternative to this is to use the <samp class="listingcharacter listingcharacter">node-emoji</samp> package, which allows you to use the text representation of various emojis, making your code more readable.</p>
            <p class="standard">Your implementation of the Math Trainer application is currently missing a summary of the results. To implement these in the <span class="italic">lib/summary.js</span> file, you can use the <samp class="listingcharacter listingcharacter">node-emoji</samp> package. In the first step, you install this package via the <samp class="listingcharacter listingcharacter">npm install node-emoji</samp> command. The source code in the <span class="italic">lib/summary.js</span> file is shown in <span class="crossreference "><a href="15_004.html#l15.25">Listing 15.25</a></span>.</p>
            <div class="listing " id="l15.25"><pre><span class="bold"><span class="schwarz"/><samp class="listingcharacter listingcharacter"><span class="rot">import</span><span class="schwarz"> emoji </span><span class="rot">from</span><span class="schwarz"> </span><span class="hellblau">'node-emoji'</span><span class="schwarz">;</span><br/> </samp></span><br/><span class="rot">export</span><span class="schwarz"> </span><span class="rot">default</span><span class="schwarz"> (tasks) </span><span class="dunkelblau">=&gt;</span><span class="schwarz"> {</span><br/>  <span class="rot">const</span><span class="schwarz"> correctCount </span><span class="dunkelblau">=</span><span class="schwarz"> tasks.reduce((correctCount, task) </span><span class="dunkelblau">=&gt;</span><span class="schwarz"> {</span><br/>    <span class="rot">if</span><span class="schwarz"> (task.input </span><span class="dunkelblau">===</span><span class="schwarz"> task.result) {</span><br/>      correctCount<span class="dunkelblau">++</span><span class="schwarz">;</span><br/>    }<br/>    <span class="rot">return</span><span class="schwarz"> correctCount;</span><br/>  }, 0);<br/>  <span class="rot">const</span><span class="schwarz"> percent </span><span class="dunkelblau">=</span><span class="schwarz"> (correctCount </span><span class="dunkelblau">*</span><span class="schwarz"> 100) </span><span class="dunkelblau">/</span><span class="schwarz"> tasks.length;</span><br/>  <span class="rot">if</span><span class="schwarz"> (percent </span><span class="dunkelblau">===</span><span class="schwarz"> 100) {</span><br/>    <span class="bold"><samp class="listingcharacter listingcharacter"><span class="rot">return</span><span class="schwarz"> emoji.emojify(</span><br/>      <span class="violett">`:trophy: Congratulations, you have solved all ${tasks.length} tasks </span></samp></span><img alt="inline image" class="inline_image" src="bilder/umbruchpfeil.png"/><span class="bold"><samp class="listingcharacter listingcharacter"><br/>        correctly.`<span class="schwarz">,</span><br/>    );</samp></span><br/>  } <span class="rot">else</span><span class="schwarz"> </span><span class="rot">if</span><span class="schwarz"> (percent </span><span class="dunkelblau">&gt;=</span><span class="schwarz"> 50) {</span><br/>    <span class="bold"><samp class="listingcharacter listingcharacter"><span class="rot">return</span><span class="schwarz"> emoji.emojify(</span><br/>      <span class="violett">`:sunglasses: Very good, you have correctly solved ${correctCount} out of </span></samp></span><img alt="inline image" class="inline_image" src="bilder/umbruchpfeil.png"/><span class="bold"><samp class="listingcharacter listingcharacter"><br/>        ${tasks.length} tasks.`<span class="schwarz">,</span><br/>    );</samp></span><br/>  } <span class="rot">else</span><span class="schwarz"> </span><span class="rot">if</span><span class="schwarz"> (percent </span><span class="dunkelblau">&gt;=</span><span class="schwarz"> 1) {</span><br/>    <span class="bold"><samp class="listingcharacter listingcharacter"><span class="rot">return</span><span class="schwarz"> emoji.emojify(</span><br/>      <span class="violett">`:cry: You have correctly solved ${correctCount} out of ${tasks.length} tasks, </span></samp></span><img alt="inline image" class="inline_image" src="bilder/umbruchpfeil.png"/><span class="bold"><samp class="listingcharacter listingcharacter"><br/>        you can do better.`<span class="schwarz">,</span><br/>    );</samp></span><br/>  } <span class="rot">else</span><span class="schwarz"> {</span><br/>    <span class="bold"><samp class="listingcharacter listingcharacter"><span class="rot">return</span><span class="schwarz"> emoji.emojify(</span><br/>      <span class="violett">`:skull_and_crossbones: </span></samp></span><img alt="inline image" class="inline_image" src="bilder/umbruchpfeil.png"/><span class="bold"><samp class="listingcharacter listingcharacter"><br/>        Your answers to all ${tasks.length} tasks are wrong.`<span class="schwarz">,</span><br/>    );</samp></span><br/>  }<br/>}; <span class="schwarz"/></pre></div>
            <p class="caption "><b>Listing 15.25</b>    
            Preparation of the Results Summary (lib/summary.js)</p>
            <p class="standard"><a id="p475"/>To display the result, you divide it into four categories: The user solved all tasks correctly, the user solved more than 50% correctly, the user solved less than 50% correctly, and the user didn’t solve any task correctly. You can use the <samp class="listingcharacter listingcharacter">emoji.emojify</samp> method to generate a character string that contains an emoji. This method should be marked with colons. The <samp class="listingcharacter listingcharacter">emoji.emojify(':trophy:')</samp> call creates a character string containing the trophy emoji. In the last step you need to display the generated character string. You can do this by calling the helper function for summaries before you exit the process. <span class="crossreference "><a href="15_004.html#l15.26">Listing 15.26</a></span> contains the customized source code of the <span class="italic">lib/index.js</span> file.</p>
            <div class="listing " id="l15.26"><pre><span class="rot">import</span><span class="schwarz"> </span><span class="schwarz">{</span><span class="schwarz"> createInterface </span><span class="schwarz">}</span><span class="schwarz"> </span><span class="rot">from</span><span class="schwarz"> </span><span class="hellblau">'readline'</span><span class="schwarz">;</span><span class="schwarz"><br/></span><span class="rot">import</span><span class="schwarz"> chalk </span><span class="rot">from</span><span class="schwarz"> </span><span class="hellblau">'chalk'</span><span class="schwarz">;</span><span class="schwarz"><br/></span><span class="rot">import</span><span class="schwarz"> createTask </span><span class="rot">from</span><span class="schwarz"> </span><span class="hellblau">'./task.js'</span><span class="schwarz">;</span><span class="schwarz"><br/></span><span class="rot">import</span><span class="schwarz"> promisedQuestion </span><span class="rot">from</span><span class="schwarz"> </span><span class="hellblau">'./promisedQuestion.js'</span><span class="schwarz">;</span><span class="schwarz"><br/></span><span class="rot">import</span><span class="schwarz"> getOptions </span><span class="rot">from</span><span class="schwarz"> </span><span class="hellblau">'./getOptions.js'</span><span class="schwarz">;</span><span class="schwarz"><br/></span><span class="bold"><span class="schwarz"/><samp class="listingcharacter listingcharacter"><span class="rot">import</span><span class="schwarz"> summary </span><span class="rot">from</span><span class="schwarz"> </span><span class="hellblau">'./summary.js'</span><span class="schwarz">;</span><br/> </samp></span><br/><span class="rot">const</span><span class="schwarz"> { amount, level } </span><span class="dunkelblau">=</span><span class="schwarz"> getOptions();</span><br/> <br/><span class="rot">const</span><span class="schwarz"> operations </span><span class="dunkelblau">=</span><span class="schwarz"> [</span><span class="hellblau">'+'</span><span class="schwarz">, </span><span class="hellblau">'-'</span><span class="schwarz">, </span><span class="hellblau">'*'</span><span class="schwarz">, </span><span class="hellblau">'/'</span><span class="schwarz">];</span><br/><span class="rot">const</span><span class="schwarz"> tasks </span><span class="dunkelblau">=</span><span class="schwarz"> [];</span><br/> <br/>operations.forEach((operation) <span class="dunkelblau">=&gt;</span><span class="schwarz"> {</span><br/>  <span class="rot">for</span><span class="schwarz"> (</span><span class="rot">let</span><span class="schwarz"> i </span><span class="dunkelblau">=</span><span class="schwarz"> 0; i </span><span class="dunkelblau">&lt;</span><span class="schwarz"> amount; i</span><span class="dunkelblau">++</span><span class="schwarz">) {</span><br/>    tasks.push(createTask(operation, level));<br/>  }<br/>});<br/> <br/><span class="rot">const</span><span class="schwarz"> rl </span><span class="dunkelblau">=</span><span class="schwarz"> createInterface({</span><br/>  input: process.stdin,<br/>  output: process.stdout,<br/>});<br/> <br/><span class="rot">async</span><span class="schwarz"> </span><span class="rot">function</span><span class="schwarz"> question(index) {</span><br/>  <span class="rot">const</span><span class="schwarz"> result </span><span class="dunkelblau">=</span><span class="schwarz"> </span><span class="rot">await</span><span class="schwarz"> promisedQuestion(</span><span class="violett">`${tasks[index].task} = `</span><span class="schwarz">, rl);</span><br/>  tasks[index].input <span class="dunkelblau">=</span><span class="schwarz"> parseInt(result);</span><br/>  <span class="rot">if</span><span class="schwarz"> (tasks[index].input </span><span class="dunkelblau">===</span><span class="schwarz"> tasks[index].result) {</span><br/>    <span class="magenta">console</span><span class="schwarz">.log(chalk.bold.green(</span><span class="hellblau">'Correct!'</span><span class="schwarz">));</span><br/>  } <span class="rot">else</span><span class="schwarz"> {</span><br/>    <span class="magenta">console</span><span class="schwarz">.log(chalk.bold.red(</span><span class="hellblau">'Wrong'</span><span class="schwarz">));</span><br/>  }<br/>  <span class="rot">if</span><span class="schwarz"> (</span><span class="dunkelblau">++</span><span class="schwarz">index </span><span class="dunkelblau">&lt;</span><span class="schwarz"> tasks.length) {</span><br/>    question(index);<br/>  } <span class="rot">else</span><span class="schwarz"> {</span><br/>    <span class="bold"><samp class="listingcharacter listingcharacter"><span class="magenta">console</span><span class="schwarz">.log(summary(tasks));</span></samp></span><br/>    rl.close();<br/><a id="p476"/>  }<br/>}<br/> <br/>question(0); <span class="schwarz"/></pre></div>
            <p class="caption "><b>Listing 15.26</b>    
            Summary Display (lib/index.js)</p>
            <p class="standard">In addition to formatting strings, the <samp class="listingcharacter listingcharacter">node-emoji</samp> package is also capable of resolving emojis in character strings or assigning them a random emoji. You can find the project site at <span class="url"><a href="https://github.com/omnidan/node-emoji">https://github.com/omnidan/node-emoji</a></span>.</p>
        
    </div><p class="signatur"/>
                    </body>
                </html>