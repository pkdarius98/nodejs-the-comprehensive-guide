<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
                    
        <head><meta content="application/xhtml+xml; charset=utf-8" http-equiv="Content-Type"/>
            <meta content="application/xhtml+xml; charset=utf-8" name="content-type"/>
            <meta content="Type-Safe Applications in Node.js" name="title"/>
            <meta content="Sebastian Springer" name="author"/>
            <meta content="Rheinwerk Publishing" name="publisher"/>
            <meta content="© 2022 by Rheinwerk Publishing Inc., Boston (MA)" name="copyright"/>
            <meta content="Node.js - The Comprehensive Guide - Type-Safe Applications in Node.js" name="description"/>
            <meta content="en" name="language"/>
            <title>Type-Safe Applications in Node.js</title>
            <link href="common/main.css" rel="stylesheet" type="text/css"/>
<meta content="urn:uuid:e0000000-0000-0000-0000-000029756394" name="Adept.expected.resource"/>
        </head>
    


                    <body class="office_us type_kapitel">
                        <div id="main">
        <h2 class="t2" id="h13.8">13.8    TypeScript in Use in a Node.js Application</h2>
        <p class="standard">If you use TypeScript in your application, you should install the <span class="italic">type definitions</span> for Node.js. These type definitions ensure that the core Node.js modules are type-defined so that you get better support from your development environment, and the TypeScript compiler doesn’t throw unnecessary error messages that result from using the platform. The type definitions<a class="indexanchor" id="i13_89"/> are available as an npm package and can be installed using the <samp class="listingcharacter listingcharacter">npm install -D @types/node</samp> command. They are installed as <samp class="listingcharacter listingcharacter">devDependency</samp> for normal applications because they aren’t required for production operation. However, if you develop a library that can be used in other applications, you should always install such type definitions as a dependency so that consumers of your library don’t need to install them manually.</p>
        
            <h3 class="t3" id="h13.8.1">13.8.1    Type Definitions<a class="indexanchor" id="i13_90"/></h3>
            <p class="standard">Type definitions exist not only for Node.js itself, but for numerous other libraries and frameworks originally written in JavaScript. The DefinitelyTyped<a class="indexanchor" id="i13_91"/> project at <span class="url"><a href="http://definitelytyped.org/">http://definitelytyped.org/</a></span> serves as the source for the type definitions. Generally, type definitions are located below the <samp class="listingcharacter listingcharacter">@types</samp><a class="indexanchor" id="i13_92"/> namespace. If you install such a type definition, the TypeScript compiler finds it automatically, so you don’t need to make any further configuration.</p>
            <p class="standard">If you work on an Express application, you should install the type definitions using the <samp class="listingcharacter listingcharacter">npm install -D @types/express</samp> command. However, you should use caution when using type definitions. Make sure that the version of the type definition matches the version of the library you’re using. Otherwise, the API may have changed, and TypeScript may be issuing warnings in the wrong places.</p>
        
        
            <h3 class="t3" id="h13.8.2">13.8.2    Creating Custom Type Definitions<a class="indexanchor" id="i13_93"/></h3>
            <p class="standard">If you’re gradually transitioning your application to TypeScript or including existing library files in a TypeScript project, you can also create your own type definitions. These are stored in files with the extension <span class="italic">.d.ts</span>. Suppose your library file is named <span class="italic">module.js</span> and contains the source code from <span class="crossreference "><a href="13_008.html#l13.29">Listing 13.29</a></span>.</p>
            <div class="listing " id="l13.29"><pre>module<span class="schwarz">.</span><span class="schwarz">exports </span><span class="dunkelblau">=</span><span class="schwarz"> </span><span class="schwarz">{</span><span class="schwarz"><br/></span>  <span class="schwarz">add(</span><span class="schwarz">a</span><span class="schwarz">,</span><span class="schwarz"> b</span><span class="schwarz">)</span><span class="schwarz"> </span><span class="schwarz">{</span><span class="schwarz"><br/></span>    <span class="rot">return</span><span class="schwarz"> a </span><span class="dunkelblau">+</span><span class="schwarz"> b</span><span class="schwarz">;</span><span class="schwarz"><br/></span><a id="p411"/>  <span class="schwarz">},</span><span class="schwarz"><br/></span><span class="schwarz">};</span><span class="schwarz"> </span></pre></div>
            <p class="caption "><b>Listing 13.29</b>    
            JavaScript Module (module.js)</p>
            <p class="standard">With the appropriate type definition from <span class="crossreference "><a href="13_008.html#l13.30">Listing 13.30</a></span>, you can include the functionality in your TypeScript application. You save the source code in a file named <span class="italic">module.d.ts</span>.</p>
            <div class="listing " id="l13.30"><pre>declare <span class="rot">function</span><span class="schwarz"> </span><span class="schwarz">add(</span><span class="schwarz">a</span><span class="schwarz">:</span><span class="schwarz"> number</span><span class="schwarz">,</span><span class="schwarz"> b</span><span class="schwarz">:</span><span class="schwarz"> number</span><span class="schwarz">):</span><span class="schwarz"> number</span><span class="schwarz">;</span><span class="schwarz"><br/></span><span class="rot">export</span><span class="schwarz"> </span><span class="schwarz">{</span><span class="schwarz"> add </span><span class="schwarz">};</span><span class="schwarz"> </span></pre></div>
            <p class="caption "><b>Listing 13.30</b>    
            Type Definition for the JavaScript Module (module.d.ts)</p>
            <p class="standard">With these two files, you can now include the module in your application and access the type support of the compiler (see <span class="crossreference "><a href="13_008.html#l13.31">Listing 13.31</a></span>).</p>
            <div class="listing " id="l13.31"><pre><span class="rot">import</span><span class="schwarz"> </span><span class="schwarz">{</span><span class="schwarz"> add </span><span class="schwarz">}</span><span class="schwarz"> </span><span class="rot">from</span><span class="schwarz"> </span><span class="hellblau">'./module'</span><span class="schwarz">;</span><span class="schwarz"><br/></span><br/><span class="magenta">console</span><span class="schwarz">.log(add(1,</span><span class="schwarz"> </span><span class="schwarz">2));</span><span class="gruen"> // Output: 3</span><span class="schwarz"> </span></pre></div>
            <p class="caption "><b>Listing 13.31</b>    
            Integrating the JavaScript Module in TypeScript (index.ts)</p>
        
        
            <h3 class="t3" id="h13.8.3">13.8.3    Sample Express Application<a class="indexanchor" id="i13_94"/></h3>
            <p class="standard">All the features presented to you in this chapter also apply in regular Node.js applications with the established libraries and frameworks, as you can see in the following example with Express. To do this, you first initialize your project with <samp class="listingcharacter listingcharacter">npm init -y</samp> and then install Express, the associated type definitions, and <samp class="listingcharacter listingcharacter">ts-node</samp> via the <samp class="listingcharacter listingcharacter">npm install express</samp> and <samp class="listingcharacter listingcharacter">npm install -D @types/express ts-node</samp> commands. Then, you can implement the entry file of your application. <span class="crossreference "><a href="13_008.html#l13.32">Listing 13.32</a></span> shows a very simple variant of it.</p>
            <div class="listing " id="l13.32"><pre><span class="rot">import</span><span class="schwarz"> express</span><span class="schwarz">,</span><span class="schwarz"> </span><span class="schwarz">{</span><span class="schwarz"> Request</span><span class="schwarz">,</span><span class="schwarz"> Response </span><span class="schwarz">}</span><span class="schwarz"> </span><span class="rot">from</span><span class="schwarz"> </span><span class="hellblau">'express'</span><span class="schwarz">;</span><span class="schwarz"><br/></span> <br/><span class="rot">const</span><span class="schwarz"> app </span><span class="dunkelblau">=</span><span class="schwarz"> </span><span class="schwarz">express();</span><span class="schwarz"><br/></span> <br/>app<span class="schwarz">.get(</span><span class="hellblau">'/'</span><span class="schwarz">,</span><span class="schwarz"> </span><span class="schwarz">(</span><span class="schwarz">req</span><span class="schwarz">:</span><span class="schwarz"> Request</span><span class="schwarz">,</span><span class="schwarz"> res</span><span class="schwarz">:</span><span class="schwarz"> Response</span><span class="schwarz">):</span><span class="schwarz"> </span><span class="rot">void</span><span class="schwarz"> </span><span class="dunkelblau">=&gt;</span><span class="schwarz"> </span><span class="schwarz">{</span><span class="schwarz"><br/></span>  res<span class="schwarz">.send(</span><span class="hellblau">'Hello Client'</span><span class="schwarz">);</span><span class="schwarz"><br/></span><span class="schwarz">});</span><span class="schwarz"><br/></span> <br/>app<span class="schwarz">.listen(8080,</span><span class="schwarz"> </span><span class="schwarz">():</span><span class="schwarz"> </span><span class="rot">void</span><span class="schwarz"> </span><span class="dunkelblau">=&gt;</span><span class="schwarz"><br/></span>  <span class="magenta">console</span><span class="schwarz">.log(</span><span class="hellblau">'Server is listening to http://localhost:8080'</span><span class="schwarz">),</span><span class="schwarz"><br/></span><span class="schwarz">);</span><span class="schwarz"> </span></pre></div>
            <p class="caption "><b>Listing 13.32</b>    
            Express Server in TypeScript</p>
            <p class="standard">You can then run this code example using the <samp class="listingcharacter listingcharacter">npx ts-node index.ts</samp> command. With the type definitions for Express installed, you can use reliable autocompletion in your <a id="p412"/>development environment. In addition, the TypeScript compiler alerts you in case of errors. For example, if you forget the path in the routing function and only specify the callback function, the compiler throws an error.</p>
            <p class="standard">The type definition allows you to correctly mark up the parameters list of the routing callback function with the types in your source code. This way, your code is additionally documented and easier to understand even at first glance.</p>
        
    </div><p class="signatur"/>
                    </body>
                </html>